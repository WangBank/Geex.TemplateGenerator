<!-- [acl]="AppPermission.<%= classify(name) %>sMutationCreate<%= classify(name) %>" -->

<page-header>
  <div style="display: flex;flex-wrap: wrap;">
    <div>
      <input type="text"
             nz-input
             [(ngModel)]="filter"
             placeholder="请输入搜索条件" />
    </div>
    <div>
      <button (click)="refresh()"
              nz-button
              nzType="primary">
        <i nz-icon
           nzType="reload"
           nzTheme="outline"></i>
        刷新</button>
      <button (click)="add()"
              nz-button
              nzType="primary">
        <i nz-icon
           nzType="plus"
           nzTheme="outline"></i>
        新建</button>
    </div>
  </div>


</page-header>
<nz-card>
  <nz-alert [nzType]="'info'"
            [nzShowIcon]="true"
            [nzMessage]="message">
    <ng-template #message>
      <div>
        <span [innerHTML]="'已选择 '+selectedData?.length+' 项'"></span>
        <nz-divider nzType="vertical"></nz-divider>
        <a (click)="refresh()"><i nz-icon
             nzType="reload"></i>
          刷新
        </a>
        <ng-container>
          <nz-divider nzType="vertical"></nz-divider>
          <a (click)="filter='';refresh()"><i nz-icon
               nzType="clear"></i>
            清空
          </a>
        </ng-container>
        <ng-container>
          <nz-divider nzType="vertical"></nz-divider>
          <a (click)="batchOperation('delete','<%= classify(name) %>')"><i nz-icon
               nzType="delete"></i>
            批量删除
          </a>
        </ng-container>

      </div>
    </ng-template>
  </nz-alert>
  <nz-table #basicTable
            [nzData]="context?.data">
    <thead>
      <tr>
        <th [nzChecked]="allSelected"
            [nzIndeterminate]="!allSelected && selectedData?.length > 0"
            (nzCheckedChange)="onAllChecked($event)"></th>
        <th>显示名称</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of basicTable.data">
        <td [nzChecked]="selectedData.contains(data)"
            (nzCheckedChange)="onItemChecked(data, $event)"></td>
        <td style="text-align: center;">{{data.name}}</td>
        <td style="text-align: center;">
          <a (click)="edit(data.id)">编辑</a>
          <nz-divider nzType="vertical"></nz-divider>
          <a nz-popconfirm
             nzPopconfirmTitle="是否确定删除?"
             (nzOnConfirm)="delete(data.id)">删除</a>
          <!-- <a (click)="submit(data.id)">{{data.submittable?"上报":"取消上报"}}</a>
          <nz-divider nzType="vertical"></nz-divider>
          <a (click)="submit(data.id)">{{data.auditable?"审批":"取消审批"}}</a> -->
        </td>
      </tr>
    </tbody>
  </nz-table>
</nz-card>
